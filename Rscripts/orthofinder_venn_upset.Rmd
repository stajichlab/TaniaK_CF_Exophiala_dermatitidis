---
title: "upsetPlot"
author: "Tania Kurbessoian"
date: "9/19/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R}
library(UpSetR)
library(RColorBrewer)
library(limma)
library(ggplot2)
library(VennDiagram)
library(ggvenn)
library(ggVennDiagram)
library(ggplot2)
library(gplots)
library(eulerr)
```

```{R}
#Load in file
Counts <- read.csv("geneCount.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
Counts <- read.csv("Orthogroups2.GeneCount.tsv", header = TRUE, sep = "\t", stringsAsFactors=FALSE)

#write.csv(Counts,"binary_count.txt", sep = "\t", row.names = FALSE)
#rownames(Counts) <- c(Counts$Orthogroup)
Counts[Counts > 0] <- 1
Counts <- read.csv("binary_count.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
Bin_counts <- read.csv("binary.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
colnames(Counts) <- c("Orthogroups","E_dermatitidis_DCF04", "E_dermatitidis_NIHUT8656")

# Assign 1 to data larger than 0 (binary presence/absence file)

# Make upset plot
z <- unlist(c("E_dermatitidis_DCF04", "E_dermatitidis_NIHUT8656")) #species/strains you want to look at

#x <- as.matrix(data)
brew.colors <- brewer.pal(6,"Dark2") #this just gets a list of default colors for me to put in for "col1, col2" etc. below - the default colors sometimes look too similar)

upset(Counts, keep.order = TRUE)

venn_counts.ao <- vennCounts(Bin_counts)
Out_venn <- vennDiagram(venn_counts.ao , cex = c(0.6, 0.8, 0.8), names = c("Exophiala dermatitidis DCF04", "Exophiala dermatitidis NIHUT8656"), circle.col = c("#DCE318FF", "#1F968BFF"), mar=rep(0.2,4))
```

```{R}
grid.newpage()
venn.plot <- draw.pairwise.venn(area1=8266, area2=8261, cross.area = 8256, category = c("Exophiala dermatitidis DCF04", "Exophiala dermatitidis NIH/UT8656"), scaled = FALSE, fill = c('#DCE318FF', '#1F968BFF'), lty = "blank", cex = c("1.5","1.5","1.5"), cat.cex = 1.2, cat.dist = c(0.1, 0.1), cat.pos = c(345, 12), margin = 0.04)
png(filename = 'plots/Venn_diagram.png', width = 6, height = 5, units= 'in', res = 100) 
grid.draw(venn.plot) 
dev.off()

grid.newpage()

```