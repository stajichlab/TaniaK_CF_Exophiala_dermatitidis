---
title: "Pairwise Comparison Distance Matrix"
author: "Tania Kurbessoian"
date: "11/2/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R}
library(ape)
library(patchwork)
library(ggplot2)
library(readr)
library(dplyr)
library(tidyverse)
library(RColorBrewer)
library(magrittr)
library(reshape)
library(data.table)
library(stringr)
library(viridis)
library(cowplot)
```


```{R}
SNP <- read.table("SNP_up.txt", sep ="\t", 
                     header = TRUE)
INDEL <- read.table("INDEL_up.txt", sep ="\t", 
                     header = TRUE)
#SNP_rf <-reshape(SNP, direction="wide", idvar="V2", timevar="V1")

#INDEL_rf <-reshape(INDEL, direction="wide", idvar="V2", timevar="V1")

#as.dist(xtabs(SNP[, 3] ~ SNP[, 2] + SNP[, 1]))
#as.dist(xtabs(INDEL[, 3] ~ INDEL[, 2] + INDEL[, 1]))

contingency_table_SNP <- xtabs(SNP ~ Label.1 + Label.2, SNP)
contingency_table_SNP

contingency_table_INDEL <- xtabs(INDEL ~ Label.1 + Label.2, INDEL)

#https://stackoverflow.com/questions/25061822/ggplot-geom-text-font-size-control
#https://stackoverflow.com/questions/47667994/ggplot-x-axis-labels-with-all-x-axis-values
#https://jtr13.github.io/spring19/Community_Contribution_xs2291.html
#https://stackoverflow.com/questions/69084649/p-values-heatmap-representation-of-all-pairwise-comparisons-p-values-with-r-e
#https://search.r-project.org/CRAN/refmans/cowplot/html/plot_grid.html

ID <- 1:23

SNP_plot <- ggplot(SNP) + geom_tile(aes(Label.1, Label.2, fill = SNP)) + geom_text(aes(Label.1, Label.2, label = SNP),  size=2) + labs(title="Exophiala dermatitidis SNP Pairwise Distance Matrix ",x="Strains",y="Strains") + scale_x_continuous("Strains", labels = as.character(ID), breaks = ID) + scale_y_continuous("Strains", labels = as.character(ID), breaks = ID) + theme(panel.grid.major = element_blank()) + scale_fill_gradient("SNP", low="red", high="white")

ggsave(filename="Distance_matrix_SNP.pdf",width=6,height=4)
ggsave(filename="Distance_matrix_SNP.png",width=6,height=4)
```

```{R} 
#INDEL
ID <- 1:23

INDEL_plot <- ggplot(INDEL) + geom_tile(aes(Label.1, Label.2, fill = INDEL)) + geom_text(aes(Label.1, Label.2, label = INDEL),  size=2) + labs(title="Exophiala dermatitidis INDEL Pairwise Distance Matrix ",x="Strains",y="Strains") + scale_x_continuous("Strains", labels = as.character(ID), breaks = ID) + scale_y_continuous("Strains", labels = as.character(ID), breaks = ID) + theme(panel.grid.major = element_blank()) + scale_fill_gradient("INDEL", low="red", high="white")

ggsave(filename="Distance_matrix_INDEL.pdf",width=6,height=4)
ggsave(filename="Distance_matrix_INDEL.png",width=6,height=4)
```

```{R}
pdf("SNP_INDEL.pdf", width=13, height=8)
q<-plot_grid( SNP_plot, INDEL_plot, D,  labels = c('A', 'B', 'C'))

ggsave("SNP_INDEL.png",  # filename of your choosing
       q,         # your tree
       device = "png",       # what kind of file should it be saved as?
       dpi = 400,             # resolution of the tree
       units = "cm",          # units to use in the height and width arguments
       height = 20,           # height of the image
       width = 35)
q
dev.off()
```
